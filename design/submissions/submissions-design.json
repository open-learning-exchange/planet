{"views":{"submissionCounts":{"map":"function(doc) {\n        if (doc.type === 'survey') {\n          var teamId = doc.team && doc.team._id ? doc.team._id : null;\n          var status = doc.status || 'pending';\n          // Emit for counting: [parentId, teamId, status] -> 1\n          emit([doc.parentId, teamId, status], 1);\n        }\n      }","reduce":"_count"},"parentSurveys":{"map":"function(doc) {\n        if (doc.type === 'survey' && doc.parent && doc.parent._id) {\n          var teamId = doc.team && doc.team._id ? doc.team._id : null;\n          var status = doc.status || 'pending';\n          // Emit parent metadata: key is parent._id for easy lookup\n          emit(doc.parent._id, {\n            parentDoc: {\n              _id: doc.parent._id,\n              _rev: doc.parent._rev,\n              name: doc.parent.name,\n              description: doc.parent.description,\n              questions: doc.parent.questions,\n              type: doc.parent.type,\n              sourcePlanet: doc.parent.sourcePlanet\n            },\n            status: status,\n            teamId: teamId\n          });\n        }\n      }"}}}
